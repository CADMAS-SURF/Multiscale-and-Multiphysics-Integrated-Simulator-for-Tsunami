INTEGER(8) FUNCTION MUSED()

  USE M_VAL
  USE MPC_WORK
  USE M_PART

  IMPLICIT NONE

  INTEGER(8) :: M

  M = 0

  IF( ALLOCATED(ISUB) ) M = M + SIZE(ISUB)
  IF( ALLOCATED(RTIM) ) M = M + SIZE(RTIM)*2
  IF( ALLOCATED(ICRD) ) M = M + SIZE(ICRD)
  IF( ALLOCATED(CORD) ) M = M + SIZE(CORD)*2
  IF( ALLOCATED(INDG) ) M = M + SIZE(INDG)
  IF( ALLOCATED(IGCD) ) M = M + SIZE(IGCD)
  IF( ALLOCATED(GRID) ) M = M + SIZE(GRID)*2
  IF( ALLOCATED(IELM) ) M = M + SIZE(IELM)
  IF( ALLOCATED(THK ) ) M = M + SIZE(THK )*2
  IF( ALLOCATED(RODA) ) M = M + SIZE(RODA)*2
  IF( ALLOCATED(BARD) ) M = M + SIZE(BARD)*2
  IF( ALLOCATED(BVEC) ) M = M + SIZE(BVEC)*2
  IF( ALLOCATED(JELS) ) M = M + SIZE(JELS)
  IF( ALLOCATED(PELS) ) M = M + SIZE(PELS)*2
  IF( ALLOCATED(MAT ) ) M = M + SIZE(MAT )
  IF( ALLOCATED(AMAT) ) M = M + SIZE(AMAT)*2
  IF( ALLOCATED(MATT) ) M = M + SIZE(MATT)
  IF( ALLOCATED(ITM1) ) M = M + SIZE(ITM1)
  IF( ALLOCATED(TBM1) ) M = M + SIZE(TBM1)*2
  IF( ALLOCATED(ISPD) ) M = M + SIZE(ISPD)
  IF( ALLOCATED(NSPD) ) M = M + SIZE(NSPD)
  IF( ALLOCATED(SPCD) ) M = M + SIZE(SPCD)*2
  IF( ALLOCATED(LOAD) ) M = M + SIZE(LOAD)
  IF( ALLOCATED(SLOD) ) M = M + SIZE(SLOD)*2
  IF( ALLOCATED(SILD) ) M = M + SIZE(SILD)*2
  IF( ALLOCATED(LILD) ) M = M + SIZE(LILD)
  IF( ALLOCATED(IFC ) ) M = M + SIZE(IFC )
  IF( ALLOCATED(NFC ) ) M = M + SIZE(NFC )
  IF( ALLOCATED(FC  ) ) M = M + SIZE(FC  )*2
  IF( ALLOCATED(IPL4) ) M = M + SIZE(IPL4)
  IF( ALLOCATED(NPL4) ) M = M + SIZE(NPL4)
  IF( ALLOCATED(PLD4) ) M = M + SIZE(PLD4)*2
  IF( ALLOCATED(IPL1) ) M = M + SIZE(IPL1)
  IF( ALLOCATED(NPL1) ) M = M + SIZE(NPL1)
  IF( ALLOCATED(PLD1) ) M = M + SIZE(PLD1)*2
  IF( ALLOCATED(IGRV) ) M = M + SIZE(IGRV)
  IF( ALLOCATED(GRAV) ) M = M + SIZE(GRAV)*2
  IF( ALLOCATED(IRFC) ) M = M + SIZE(IRFC)
  IF( ALLOCATED(RFRC) ) M = M + SIZE(RFRC)*2
  IF( ALLOCATED(ITMP) ) M = M + SIZE(ITMP)
  IF( ALLOCATED(TEMP) ) M = M + SIZE(TEMP)*2
  IF( ALLOCATED(ITP1) ) M = M + SIZE(ITP1)
  IF( ALLOCATED(ITPF) ) M = M + SIZE(ITPF)
  IF( ALLOCATED(TMP1) ) M = M + SIZE(TMP1)*2
  IF( ALLOCATED(ISPA) ) M = M + SIZE(ISPA)
  IF( ALLOCATED(NSPA) ) M = M + SIZE(NSPA)
  IF( ALLOCATED(ISP1) ) M = M + SIZE(ISP1)
  IF( ALLOCATED(NSP1) ) M = M + SIZE(NSP1)
  IF( ALLOCATED(ISPC) ) M = M + SIZE(ISPC)
  IF( ALLOCATED(NSPC) ) M = M + SIZE(NSPC)
  IF( ALLOCATED(SPC ) ) M = M + SIZE(SPC )*2
  IF( ALLOCATED(IMPA) ) M = M + SIZE(IMPA)
  IF( ALLOCATED(NMPA) ) M = M + SIZE(NMPA)
  IF( ALLOCATED(IMPC) ) M = M + SIZE(IMPC)
  IF( ALLOCATED(JMPC) ) M = M + SIZE(JMPC)
  IF( ALLOCATED(NMPC) ) M = M + SIZE(NMPC)
  IF( ALLOCATED(AMPC) ) M = M + SIZE(AMPC)*2
  IF( ALLOCATED(NEIG) ) M = M + SIZE(NEIG)
  IF( ALLOCATED(IFR1) ) M = M + SIZE(IFR1)
  IF( ALLOCATED(FRQ1) ) M = M + SIZE(FRQ1)*2
  IF( ALLOCATED(IDLD) ) M = M + SIZE(IDLD)
  IF( ALLOCATED(SDLD) ) M = M + SIZE(SDLD)*2
  IF( ALLOCATED(SIDL) ) M = M + SIZE(SIDL)*2
  IF( ALLOCATED(LIDL) ) M = M + SIZE(LIDL)
  IF( ALLOCATED(IRL1) ) M = M + SIZE(IRL1)
  IF( ALLOCATED(LSEQ) ) M = M + SIZE(LSEQ)
  IF( ALLOCATED(ITD1) ) M = M + SIZE(ITD1)
  IF( ALLOCATED(TBD1) ) M = M + SIZE(TBD1)*2
  IF( ALLOCATED(NLP ) ) M = M + SIZE(NLP )
  IF( ALLOCATED(RNLP) ) M = M + SIZE(RNLP)*2
  IF( ALLOCATED(ISTP) ) M = M + SIZE(ISTP)
  IF( ALLOCATED(NSTP) ) M = M + SIZE(NSTP)
  IF( ALLOCATED(DELT) ) M = M + SIZE(DELT)*2
  IF( ALLOCATED(ITL1) ) M = M + SIZE(ITL1)
  IF( ALLOCATED(ICPA) ) M = M + SIZE(ICPA)
  IF( ALLOCATED(NCPA) ) M = M + SIZE(NCPA)
  IF( ALLOCATED(ICPR) ) M = M + SIZE(ICPR)
  IF( ALLOCATED(NCPR) ) M = M + SIZE(NCPR)
  IF( ALLOCATED(CPR ) ) M = M + SIZE(CPR )*2
  IF( ALLOCATED(ICRG) ) M = M + SIZE(ICRG)
  IF( ALLOCATED(NCRG) ) M = M + SIZE(NCRG)

  IF( ALLOCATED(UG1) ) M = M + SIZE(UG1)*2
  IF( ALLOCATED(UG2) ) M = M + SIZE(UG2)*2
  IF( ALLOCATED(UG3) ) M = M + SIZE(UG3)*2
  IF( ALLOCATED(UGP) ) M = M + SIZE(UGP)*2
  IF( ALLOCATED(DUG) ) M = M + SIZE(DUG)*2
  IF( ALLOCATED(POS) ) M = M + SIZE(POS)*2
  IF( ALLOCATED(POSO) ) M = M + SIZE(POSO)*2
  IF( ALLOCATED(VG0) ) M = M + SIZE(VG0)*2
  IF( ALLOCATED(VG) ) M = M + SIZE(VG)*2
  IF( ALLOCATED(VGP) ) M = M + SIZE(VGP)*2
  IF( ALLOCATED(FTO) ) M = M + SIZE(FTO)*2
  IF( ALLOCATED(FTI) ) M = M + SIZE(FTI)*2
  IF( ALLOCATED(FTID) ) M = M + SIZE(FTID)*2
  IF( ALLOCATED(FCO) ) M = M + SIZE(FCO)*2
  IF( ALLOCATED(FCK) ) M = M + SIZE(FCK)*2
  IF( ALLOCATED(FCD) ) M = M + SIZE(FCD)*2
  IF( ALLOCATED(FCM) ) M = M + SIZE(FCM)*2
  IF( ALLOCATED(FCMD) ) M = M + SIZE(FCMD)*2
  IF( ALLOCATED(FCP) ) M = M + SIZE(FCP)*2
  IF( ALLOCATED(RFCO) ) M = M + SIZE(RFCO)*2
  IF( ALLOCATED(RFCI) ) M = M + SIZE(RFCI)*2
  IF( ALLOCATED(FRCI) ) M = M + SIZE(FRCI)*2
  IF( ALLOCATED(PPND) ) M = M + SIZE(PPND)*2
  IF( ALLOCATED(PG1 ) ) M = M + SIZE(PG1 )*2
  IF( ALLOCATED(PG2 ) ) M = M + SIZE(PG2 )*2
  IF( ALLOCATED(PG3 ) ) M = M + SIZE(PG3 )*2
  IF( ALLOCATED(DPG ) ) M = M + SIZE(DPG )*2
  IF( ALLOCATED(FLO ) ) M = M + SIZE(FLO )*2
  IF( ALLOCATED(FLI ) ) M = M + SIZE(FLI )*2
  IF( ALLOCATED(WRK1) ) M = M + SIZE(WRK1)*2
  IF( ALLOCATED(WRK2) ) M = M + SIZE(WRK2)*2
  IF( ALLOCATED(WRK3) ) M = M + SIZE(WRK3)*2
  IF( ALLOCATED(D_T) ) M = M + SIZE(D_T)*2
  IF( ALLOCATED(IOUT) ) M = M + SIZE(IOUT)
  IF( ALLOCATED(IROUT) ) M = M + SIZE(IROUT)
  IF( ALLOCATED(DMT) ) M = M + SIZE(DMT)*2
  IF( ALLOCATED(EPSG) ) M = M + SIZE(EPSG)*2
  IF( ALLOCATED(SIGG) ) M = M + SIZE(SIGG)*2
  IF( ALLOCATED(IST) ) M = M + SIZE(IST)
  IF( ALLOCATED(SIGY) ) M = M + SIZE(SIGY)*2
  IF( ALLOCATED(ICSF) ) M = M + SIZE(ICSF)
  IF( ALLOCATED(ICBD) ) M = M + SIZE(ICBD)
  IF( ALLOCATED(IELC) ) M = M + SIZE(IELC)
  IF( ALLOCATED(IELCB) ) M = M + SIZE(IELCB)
  IF( ALLOCATED(INDA0) ) M = M + SIZE(INDA0)
  IF( ALLOCATED(INDC0) ) M = M + SIZE(INDC0)
  IF( ALLOCATED(INDA) ) M = M + SIZE(INDA)
  IF( ALLOCATED(INDC) ) M = M + SIZE(INDC)
  IF( ALLOCATED(IEDA) ) M = M + SIZE(IEDA)
  IF( ALLOCATED(IEDG) ) M = M + SIZE(IEDG)
  IF( ALLOCATED(IEDGB) ) M = M + SIZE(IEDGB)
  IF( ALLOCATED(IELA) ) M = M + SIZE(IELA)
  IF( ALLOCATED(ICELA) ) M = M + SIZE(ICELA)
  IF( ALLOCATED(ICEL) ) M = M + SIZE(ICEL)
  IF( ALLOCATED(ICFCA) ) M = M + SIZE(ICFCA)
  IF( ALLOCATED(ICFC) ) M = M + SIZE(ICFC)
  IF( ALLOCATED(ICEDA) ) M = M + SIZE(ICEDA)
  IF( ALLOCATED(ICED) ) M = M + SIZE(ICED)
  IF( ALLOCATED(INDCEA) ) M = M + SIZE(INDCEA)
  IF( ALLOCATED(INDCE) ) M = M + SIZE(INDCE)
  IF( ALLOCATED(IGSFR) ) M = M + SIZE(IGSFR)
  IF( ALLOCATED(IBEL) ) M = M + SIZE(IBEL)
  IF( ALLOCATED(IBTE) ) M = M + SIZE(IBTE)
  IF( ALLOCATED(IELQ) ) M = M + SIZE(IELQ)
  IF( ALLOCATED(IFCQ) ) M = M + SIZE(IFCQ)
  IF( ALLOCATED(IEDQ) ) M = M + SIZE(IEDQ)
  IF( ALLOCATED(IVRQ) ) M = M + SIZE(IVRQ)
  IF( ALLOCATED(GELC) ) M = M + SIZE(GELC)*2
  IF( ALLOCATED(IELG) ) M = M + SIZE(IELG)
  IF( ALLOCATED(ICTB) ) M = M + SIZE(ICTB)
  IF( ALLOCATED(ISLV0) ) M = M + SIZE(ISLV0)
  IF( ALLOCATED(ISLVP) ) M = M + SIZE(ISLVP)
  IF( ALLOCATED(RSLV0) ) M = M + SIZE(RSLV0)*2
  IF( ALLOCATED(PSLV) ) M = M + SIZE(PSLV)*2
  IF( ALLOCATED(ISLV) ) M = M + SIZE(ISLV)
  IF( ALLOCATED(ISLVO) ) M = M + SIZE(ISLVO)
  IF( ALLOCATED(RSLV) ) M = M + SIZE(RSLV)*2
  IF( ALLOCATED(IRANK) ) M = M + SIZE(IRANK)
  IF( ALLOCATED(FRTB) ) M = M + SIZE(FRTB)*2
  IF( ALLOCATED(U0) ) M = M + SIZE(U0)*2
  IF( ALLOCATED(RL0) ) M = M + SIZE(RL0)*2
  IF( ALLOCATED(IFRIC) ) M = M + SIZE(IFRIC)
  IF( ALLOCATED(ISTICK) ) M = M + SIZE(ISTICK)
  IF( ALLOCATED(ISTK) ) M = M + SIZE(ISTK)
  IF( ALLOCATED(FRIC) ) M = M + SIZE(FRIC)*2
  IF( ALLOCATED(EDML) ) M = M + SIZE(EDML)*2
  IF( ALLOCATED(IPFC) ) M = M + SIZE(IPFC)
  IF( ALLOCATED(AFC ) ) M = M + SIZE(AFC )*2
  IF( ALLOCATED(IPND) ) M = M + SIZE(IPND)
  IF( ALLOCATED(PTIM) ) M = M + SIZE(PTIM)*2
  IF( ALLOCATED(PND ) ) M = M + SIZE(PND )*2
  IF( ALLOCATED(VELG) ) M = M + SIZE(VELG)*2
  IF( ALLOCATED(VELE) ) M = M + SIZE(VELE)*2
  IF( ALLOCATED(IRF) ) M = M + SIZE(IRF)
  IF( ALLOCATED(IRND) ) M = M + SIZE(IRND)
  IF( ALLOCATED(IRMSH) ) M = M + SIZE(IRMSH)
  IF( ALLOCATED(RMSH) ) M = M + SIZE(RMSH)*2
  IF( ALLOCATED(DELZ) ) M = M + SIZE(DELZ)*2
  IF( ALLOCATED(SUMZ) ) M = M + SIZE(SUMZ)*2
  IF( ALLOCATED(INDOF0) ) M = M + SIZE(INDOF0)
  IF( ALLOCATED(INDOF) ) M = M + SIZE(INDOF)
  IF( ALLOCATED(INDMPC) ) M = M + SIZE(INDMPC)
  IF( ALLOCATED(MPCF) ) M = M + SIZE(MPCF)
  IF( ALLOCATED(RMPC) ) M = M + SIZE(RMPC)*2
  IF( ALLOCATED(INDOP0) ) M = M + SIZE(INDOP0)
  IF( ALLOCATED(INDOP) ) M = M + SIZE(INDOP)
  IF( ALLOCATED(RHV) ) M = M + SIZE(RHV)*2
  IF( ALLOCATED(X) ) M = M + SIZE(X)*2
  IF( ALLOCATED(IDSK) ) M = M + SIZE(IDSK)
  IF( ALLOCATED(IDCG) ) M = M + SIZE(IDCG)
  IF( ALLOCATED(CGWK) ) M = M + SIZE(CGWK)*2
  IF( ALLOCATED(STF) ) M = M + SIZE(STF)*2
  IF( ALLOCATED(LOW) ) M = M + SIZE(LOW)*2
  IF( ALLOCATED(IASEWK) ) M = M + SIZE(IASEWK)
  IF( ALLOCATED(ASEWK) ) M = M + SIZE(ASEWK)*2
  IF( ALLOCATED(SYM) ) M = M + SIZE(SYM)
  IF( ALLOCATED(NUM) ) M = M + SIZE(NUM)*2
  IF( ALLOCATED(NP_ENS) ) M = M + SIZE(NP_ENS)
  IF( ALLOCATED(IP_ENS) ) M = M + SIZE(IP_ENS)
  IF( ALLOCATED(NG_ENS) ) M = M + SIZE(NG_ENS)
  IF( ALLOCATED(IG_ENS) ) M = M + SIZE(IG_ENS)
  IF( ALLOCATED(NE_ENS) ) M = M + SIZE(NE_ENS)
  IF( ALLOCATED(IE_ENS) ) M = M + SIZE(IE_ENS)
  IF( ALLOCATED(NG_ENSW) ) M = M + SIZE(NG_ENSW)
  IF( ALLOCATED(IG_ENSW) ) M = M + SIZE(IG_ENSW)
  IF( ALLOCATED(NE_ENSW) ) M = M + SIZE(NE_ENSW)
  IF( ALLOCATED(IE_ENSW) ) M = M + SIZE(IE_ENSW)

  IF( ALLOCATED(IDEP) ) M = M + SIZE(IDEP)
  IF( ALLOCATED(CIDP) ) M = M + SIZE(CIDP)*2
  IF( ALLOCATED(IDX) ) M = M + SIZE(IDX)
  IF( ALLOCATED(IRH) ) M = M + SIZE(IRH)
  IF( ALLOCATED(IFRH) ) M = M + SIZE(IFRH)
  IF( ALLOCATED(CRH) ) M = M + SIZE(CRH)*2
  IF( ALLOCATED(IDL) ) M = M + SIZE(IDL)
  IF( ALLOCATED(ROWL) ) M = M + SIZE(ROWL)
  IF( ALLOCATED(ROWR) ) M = M + SIZE(ROWR)
  IF( ALLOCATED(COLL) ) M = M + SIZE(COLL)
  IF( ALLOCATED(COLR) ) M = M + SIZE(COLR)
  IF( ALLOCATED(B) ) M = M + SIZE(B)*2

  IF( ALLOCATED(NOD) ) M = M + SIZE(NOD)
  IF( ALLOCATED(IEL) ) M = M + SIZE(IEL)
  IF( ALLOCATED(IPF) ) M = M + SIZE(IPF)
  IF( ALLOCATED(NODIMPW) ) M = M + SIZE(NODIMPW)
  IF( ALLOCATED(NODEXPW) ) M = M + SIZE(NODEXPW)
  IF( ALLOCATED(NODIMP) ) M = M + SIZE(NODIMP)
  IF( ALLOCATED(NODEXP) ) M = M + SIZE(NODEXP)
  IF( ALLOCATED(NODG) ) M = M + SIZE(NODG)
  IF( ALLOCATED(IEC) ) M = M + SIZE(IEC)
  IF( ALLOCATED(INC) ) M = M + SIZE(INC)
  IF( ALLOCATED(IEG) ) M = M + SIZE(IEG)
  IF( ALLOCATED(IEQ) ) M = M + SIZE(IEQ)
  IF( ALLOCATED(IBT) ) M = M + SIZE(IBT)
  IF( ALLOCATED(NODP) ) M = M + SIZE(NODP)
  IF( ALLOCATED(IELCP) ) M = M + SIZE(IELCP)
  IF( ALLOCATED(INDCP) ) M = M + SIZE(INDCP)
  IF( ALLOCATED(IEDGP) ) M = M + SIZE(IEDGP)
  IF( ALLOCATED(NODC) ) M = M + SIZE(NODC)
  IF( ALLOCATED(NODGC) ) M = M + SIZE(NODGC)
  IF( ALLOCATED(IELMC) ) M = M + SIZE(IELMC)
  IF( ALLOCATED(NODX) ) M = M + SIZE(NODX)
  IF( ALLOCATED(NODIMPX) ) M = M + SIZE(NODIMPX)
  IF( ALLOCATED(NODEXPX) ) M = M + SIZE(NODEXPX)

  MUSED = M

END