      SUBROUTINE KOJI3E(STRAIN,PSTRAIN,CMX,ITO)
C
      IMPLICIT REAL*8(A-H,O-Z)
C
C     PRINCIPAL STRAIN AND ITS DIRECTION COSINE
C     
C       STRAIN(1)=EPSILON_X
C       STRAIN(2)=EPSILON_Y
C       STRAIN(3)=EPSILON_Z
C       STRAIN(4)=GAMMA_XY = 2*EPSILON_XY
C       STRAIN(5)=GAMMA_YZ = 2*EPSILON_YZ
C       STRAIN(6)=GAMMA_ZX = 2*EPSILON_ZX
C
      DIMENSION STRAIN(6),PSTRAIN(3),CMX(3,3),STRMTX(3,3)
C
      SS=0.0D0
      DO 2000 I=1,6
 2000 SS=SS+STRAIN(I)*STRAIN(I)
      IF(SS.GT.1.0D-20)GO TO 4000
      DO 3100 I=1,3
      DO 3050 J=1,3
 3050 CMX(I,J)=0.0D0
      PSTRAIN(I)=0.0D0
 3100 CMX(I,I)=1.0D0
      GO TO 9000
C
 4000 STRMTX(1,1)=STRAIN(1)
      STRMTX(1,2)=STRAIN(4)*0.5D0
      STRMTX(1,3)=STRAIN(6)*0.5D0
      STRMTX(2,1)=STRMTX(1,2)
      STRMTX(2,2)=STRAIN(2)
      STRMTX(2,3)=STRAIN(5)*0.5D0
      STRMTX(3,1)=STRMTX(1,3)
      STRMTX(3,2)=STRMTX(2,3)
      STRMTX(3,3)=STRAIN(3)
C
      FACT=1.0D-6
      CALL JACOBI(STRMTX,PSTRAIN,CMX,3,15,FACT ,0,3,K,ITO)
C
 9000 RETURN
      END
