      SUBROUTINE GMTXTE2(EKUP,EKPP,ECPU,ECPP,EMPU,X,ITO)

      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION WG(5),RLG(4,5),EKUP(30,10),EKPP(10,10),ECPU(10,30)
     &         ,ECPP(10,10),EMPU(10,30),RN(10),X(3,10),DNDX(3,10)
     &         ,RKUP(30,10),RKPP(10,10),CPU(10,30),CPP(10,10)
     &         ,RMPU(10,30)
      DATA WG  / 4*0.075D0, -0.133333333333333D0 /
      DATA RLG /
     &    0.500000000000000D0, 0.166666666666667D0, 0.166666666666667D0
     &  , 0.166666666666667D0
     &  , 0.166666666666667D0, 0.500000000000000D0, 0.166666666666667D0
     &  , 0.166666666666667D0
     &  , 0.166666666666667D0, 0.166666666666667D0, 0.500000000000000D0
     &  , 0.166666666666667D0
     &  , 0.166666666666667D0, 0.166666666666667D0, 0.166666666666667D0
     &  , 0.500000000000000D0
     &  , 4*0.25D0 /

      EKUP(:,:) = 0.
      EKPP(:,:) = 0.
      ECPU(:,:) = 0.
      ECPP(:,:) = 0.
      EMPU(:,:) = 0.

      DO I = 1, 5

        CALL SFNTE2(RLG(1,I),RN)

        CALL DERXTE2(DNDX,DET,RLG(1,I),X,ITO)

        CALL GMTX(RKUP,RKPP,CPU,CPP,RMPU,RN,DNDX,10,30)

        EKUP(:,:) = EKUP(:,:) + RKUP(:,:)*WG(I)*DET
        EKPP(:,:) = EKPP(:,:) + RKPP(:,:)*WG(I)*DET
        ECPU(:,:) = ECPU(:,:) + CPU(:,:)*WG(I)*DET
        ECPP(:,:) = ECPP(:,:) + CPP(:,:)*WG(I)*DET
        EMPU(:,:) = EMPU(:,:) + RMPU(:,:)*WG(I)*DET

      ENDDO

      END
